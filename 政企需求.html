<!doctype html>
<html>
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, minimum-scale=1.0, maximum-scale=2.0, user-scalable=no">
<meta name="format-detection" content="telephone=no" />
<meta name="apple-mobile-web-app-status-bar-style" content="black" />
<meta content="yes" name=" apple-mobile-web-app-capable" />
<meta name="description" content="">
<meta http-equiv="pragma" content="no-cache" />
<title></title>
<script src="<{asset:u/js/201503/zepto.min.js}>"></script>
</head><body>
<form id="YC_TO_LOGREG">
<div class="box_input" style="position:relative">
    <div class="box_alert" id="b_tan" style="display:none">
      <img src="<{asset:u/images/201508/2637758771.png}>" width="80%" />
    </div>
<div class="simple_tips" id="b_msg"></div>
    <div class="msg_input">
      <label>姓　　名</label>
      <div style="padding:0 5%"><input type="text" id="b_name" name="name" class="nohighlight"></div>
    </div>

    <div class="msg_input">
      <label>联系电话</label>
      <div style="padding:0 5%"><input type="tel" id="b_tel" name="cellphone" class="nohighlight"></div>
    </div>

    <div class="msg_input">
      <label>城　　市</label>
      <div style="padding:0 5%"><input type="text" id="b_city" name="city" class="nohighlight"></div>
    </div>
        <div class="a_submit" id="b_sub">提　　交</div>
    </div>
</form>
<script type="text/javascript" src="<{asset:js/do/do.all.src.js}>"></script>
<script>
(function() {
  Do('c.common_h5', function() {
    var util = {
      proving: function() {
        if (!(/^[\u4e00-\u9fa5]{1,10}$/.test($('#b_name').val()))) {
          this.setMsg('请输入正确的姓名');
          return false;
        }
        if (!(/^1[3568][0-9]{9}$/.test($('#b_tel').val()))) {
          this.setMsg('请输入正确的电话号码');
          return false;
        }
        if (!(/^[\u4e00-\u9fa5]{1,10}$/.test($('#b_city').val()))) {
          this.setMsg('请输入正确的城市');
          return false;
        }
        return true;
      },
      setMsg: function(msg) {
        $('#b_msg').html(msg);
        var popHeight = $('#b_msg').outerHeight(),
          popWidth = $('#b_msg').outerWidth();
        //console.log(popWidth)
        $('#b_msg').css({
          "opacity": 1,
          "left": "50%",
          "top": "40%",
          "margin-top": -popHeight / 2 + 'px',
          "margin-left": -popWidth / 2 + 'px'
        }).show();
        this.time = setTimeout(function() {
          $('#b_msg').hide();
          clearTimeout(this.time)
        }, 2160);
      },
      UrlSearch: function() {
        var str = window.location.href; //取得整个地址栏
        var num = str.indexOf("?");
        str = str.substr(num + 1);
        str = str.split('&') //取得所有参数
        for (var i = 0; i < str.length; i++) {
          var ele = str[i].split('=');
          if (ele[0] == 'source') {
            return ele[1];
          }
        }
        return false;
      },
      submit_Order: function() {
        if (!this.proving()) {
          return false;
        };
        var _result = this.UrlSearch();
        var data_log = $('#YC_TO_LOGREG').serializeArray();
        if (_result) {
          var newobj = {};
          newobj.name = 'source';
          newobj.value = _result;
          data_log.push(newobj);
        };
        //console.log(data_log)
        $.post('/ajax/activity/corporate_info.php', data_log, function(res) {
          var r = $.parseJSON(res);
          if (r.ret_code == 200) {
            $('#b_tan').show(300);
            $('#b_tan').find('img').eq(0).click(function() {
            $('#b_tan').hide(300);
              //$('input[name="name"],input[name="cellphone"],input[name="city"]').val('');
            })
          } else{
            util.setMsg(r.ret_msg);
            //$('input[name="name"],input[name="cellphone"],input[name="city"]').val('');
          }
        })
      }
    };
    TOUCH_EVENTS(document.querySelector('#b_sub'), function() {
      util.submit_Order();
    });
  });
})();
</script>
</body></html>